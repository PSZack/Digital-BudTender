<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pure Shaka AI Strain & Terpene Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .card-hover-effect {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card-hover-effect:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6; /* blue-500 */
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .action-button {
            transition: all 0.2s ease-in-out;
        }
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* Tooltip Styles */
        .tooltip-trigger {
            position: relative;
            cursor: pointer;
            border-bottom: 2px dotted #9ca3af; /* gray-400 */
        }
        .tooltip-text {
            visibility: hidden;
            width: 280px;
            background-color: #1f2937; /* gray-800 */
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            line-height: 1.25rem;
            font-weight: 400;
        }
        .tooltip-trigger:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="container mx-auto p-4 sm:p-6 md:p-12">
        <!-- Header Section -->
        <header class="text-center mb-10 md:mb-16">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-3 tracking-tight">The Power of Terpenes</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                Discover the aromatic compounds that define a strain's scent, flavor, and unique effects through the 
                <span class="tooltip-trigger font-semibold text-green-600">
                    entourage effect
                    <span class="tooltip-text">The theory that all compounds in cannabis work together synergistically. Cannabinoids and terpenes combine to enhance and modulate the overall effects of the plant.</span>
                </span>.
            </p>
        </header>

        <!-- Terpenes Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
           <!-- Myrcene Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 card-hover-effect">
                <div class="flex items-center mb-4">
                    <div class="bg-blue-100 text-blue-600 rounded-full p-3 mr-4">
                        <!-- Mango Icon -->
                        <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M16.34,3.23a1,1,0,0,0-1.23.33C14.1,5.2,13.25,8,13,9.75c-.21,1.47.3,3.54,1.74,4.91a.5.5,0,0,0,.7.09,8.46,8.46,0,0,1,3.44-2.12c2-.8,3.22-2.6,3.06-4.33A5.43,5.43,0,0,0,16.34,3.23ZM18,9.5a1,1,0,1,1,1-1A1,1,0,0,1,18,9.5Z"/><path d="M12.39,12.31a5.83,5.83,0,0,1-2.82-2.19C7.49,7.1,7.1,4.8,7.18,3.25a1,1,0,0,0-2-.24C4.29,5.52,4,8.3,6.15,11.23c2.2,3,5.62,4.53,8.83,4.67a1,1,0,0,0,1-1.12C15.5,13.25,14.1,12.8,12.39,12.31Z"/></svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">Myrcene</h2>
                </div>
                 <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-blue-700 mb-1">Aroma Profile</h3>
                        <p class="text-gray-600">Earthy, musky, and clove-like with notes of tropical fruit.</p>
                    </div>
                     <div>
                        <h3 class="font-semibold text-blue-700 mb-1">Commonly Found In</h3>
                        <p class="text-gray-600">Mangoes, Hops, Lemongrass, Thyme.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-blue-700 mb-1">Potential Effects & Role</h3>
                        <p class="text-gray-600">Known as "The Enhancer," it may increase THC's effectiveness and is associated with calming, sedative "couch-lock" effects.</p>
                    </div>
                </div>
            </div>

            <!-- Limonene Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 card-hover-effect">
                <div class="flex items-center mb-4">
                    <div class="bg-yellow-100 text-yellow-600 rounded-full p-3 mr-4">
                        <!-- Lemon Icon -->
                        <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm5.43,13.84a1,1,0,0,1-1.37.37,10.4,10.4,0,0,0-4.43-1.73,1,1,0,0,1-.37-1.37C12.16,11.2,13.2,9,12.53,6.34a1,1,0,0,1,1.94-.48c1,4-1.1,7.2-4.31,9.13a1,1,0,0,1-1.28-.56,6.38,6.38,0,0,1,1-5.12,1,1,0,1,1,1.82.8A4.33,4.33,0,0,0,10.2,14a1,1,0,0,1-.56,1.28c-2,1-4.82.16-6.48-2.4A8,8,0,0,1,17.43,15.84Z"/></svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">Limonene</h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-yellow-700 mb-1">Aroma Profile</h3>
                        <p class="text-gray-600">Strong, bright citrus scents like lemon and orange.</p>
                    </div>
                     <div>
                        <h3 class="font-semibold text-yellow-700 mb-1">Commonly Found In</h3>
                        <p class="text-gray-600">Citrus Rinds, Rosemary, Peppermint.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-yellow-700 mb-1">Potential Effects & Role</h3>
                        <p class="text-gray-600">Known as "The Mood-Lifter," it's associated with elevated mood, stress relief, and an energetic, happy experience.</p>
                    </div>
                </div>
            </div>

            <!-- Pinene Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 card-hover-effect">
                <div class="flex items-center mb-4">
                    <div class="bg-green-100 text-green-600 rounded-full p-3 mr-4">
                         <!-- Pine Tree Icon -->
                         <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M19.6,8.13a1,1,0,0,0-1.2,0L13,12.53V4a1,1,0,0,0-2,0v8.53L5.6,8.13a1,1,0,1,0-1.2,1.6l7,6.13a1,1,0,0,0,1.2,0l7-6.13A1,1,0,0,0,19.6,8.13ZM12,21a1,1,0,0,0,1-1V18a1,1,0,0,0-2,0v2A1,1,0,0,0,12,21Z"/></svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">Pinene</h2>
                </div>
                 <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-green-700 mb-1">Aroma Profile</h3>
                        <p class="text-gray-600">Sharp, sweet, and refreshing scent of pine needles.</p>
                    </div>
                     <div>
                        <h3 class="font-semibold text-green-700 mb-1">Commonly Found In</h3>
                        <p class="text-gray-600">Pine Needles, Rosemary, Basil, Dill.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-green-700 mb-1">Potential Effects & Role</h3>
                        <p class="text-gray-600">Known as "The Focus Agent," it's linked to alertness and memory retention, potentially countering some of THC's fogginess.</p>
                    </div>
                </div>
            </div>
            
            <!-- Linalool Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 card-hover-effect">
                <div class="flex items-center mb-4">
                    <div class="bg-purple-100 text-purple-600 rounded-full p-3 mr-4">
                        <!-- Lavender Icon -->
                        <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M16,4a1,1,0,0,0-1,1V6.5a1,1,0,0,1-2,0V5a1,1,0,0,0-2,0V6.5a1,1,0,0,1-2,0V5a1,1,0,0,0-2,0v.5a3.5,3.5,0,0,0,7,0V5A1,1,0,0,0,16,4Z"/><path d="M10.5,12A3.5,3.5,0,0,0,7,8.5V8a1,1,0,0,0-2,0v.5A5.5,5.5,0,0,0,8.5,14H8a1,1,0,0,0,0,2h.5A5.5,5.5,0,0,0,14,21.5V22a1,1,0,0,0,2,0v-.5A3.5,3.5,0,0,0,12.5,18H13a1,1,0,0,0,0-2h-.5A3.5,3.5,0,0,0,10.5,12Zm2,6A1.5,1.5,0,1,1,14,16.5,1.5,1.5,0,0,1,12.5,18Z"/></svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">Linalool</h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-purple-700 mb-1">Aroma Profile</h3>
                        <p class="text-gray-600">Spicy and floral, famously associated with lavender.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-purple-700 mb-1">Commonly Found In</h3>
                        <p class="text-gray-600">Lavender, Coriander, Birch Bark.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-purple-700 mb-1">Potential Effects & Role</h3>
                        <p class="text-gray-600">Known as "The Calming Agent," it's prized for its relaxing, anti-anxiety, and sedative qualities, perfect for unwinding.</p>
                    </div>
                </div>
            </div>

            <!-- Beta-Caryophyllene Card -->
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8 card-hover-effect">
                <div class="flex items-center mb-4">
                    <div class="bg-red-100 text-red-600 rounded-full p-3 mr-4">
                        <!-- Peppercorn Icon -->
                        <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><circle cx="12" cy="12" r="3"/><circle cx="15" cy="9" r="1.5"/><circle cx="9" cy="9" r="1.5"/><circle cx="9" cy="15" r="1.5"/><circle cx="15" cy="15" r="1.5"/></svg>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800">Caryophyllene</h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-red-700 mb-1">Aroma Profile</h3>
                        <p class="text-gray-600">Peppery, spicy, and woody, like black pepper.</p>
                    </div>
                     <div>
                        <h3 class="font-semibold text-red-700 mb-1">Commonly Found In</h3>
                        <p class="text-gray-600">Black Pepper, Cloves, Cinnamon.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-red-700 mb-1">Potential Effects & Role</h3>
                        <p class="text-gray-600">Known as "The Therapeutic Terpene," it uniquely binds to CB2 receptors to provide potent anti-inflammatory and pain relief.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gemini API Section -->
        <section id="analyzer" class="mt-16 md:mt-24 bg-white rounded-2xl shadow-lg p-6 sm:p-8 md:p-10">
            <header class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-extrabold text-gray-800 mb-2 tracking-tight">🔬 Pure Shaka AI Strain Guide</h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">Analyze strains from our menu, or find the perfect one for your desired effect.</p>
            </header>

            <div class="max-w-4xl mx-auto">
                <!-- Strain Input -->
                <div class="mb-4">
                    <label for="strain-input" class="block text-xl font-semibold text-gray-700 mb-3 text-center">1. Analyze by Name</label>
                    <div class="flex flex-col sm:flex-row gap-2">
                        <input type="text" id="strain-input" class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition" placeholder="e.g., Ice Cream Cake, Gush Mintz...">
                        <button id="analyze-button" class="bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-700 transition-all duration-300 transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:scale-100 flex-shrink-0">
                            Analyze
                        </button>
                    </div>
                </div>

                <!-- Find by Effect Buttons -->
                <div class="mb-4 pt-4">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">2. Find by Effect</h3>
                    <div id="effect-buttons" class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                        <button class="action-button bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Anxiety">Anxiety</button>
                        <button class="action-button bg-purple-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Pain Relief">Pain Relief</button>
                        <button class="action-button bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Focus">Focus</button>
                        <button class="action-button bg-green-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Sleep">Sleep</button>
                        <button class="action-button bg-pink-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Creativity">Creativity</button>
                        <button class="action-button bg-orange-500 text-white font-semibold py-2 px-4 rounded-lg" data-effect="Energy">Energy</button>
                    </div>
                </div>
                
                <!-- Find by Terpene Buttons -->
                <div class="mb-8 pt-4">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">3. Find by Terpene</h3>
                    <div id="terpene-buttons" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3">
                        <button class="action-button bg-blue-200 text-blue-800 font-semibold py-2 px-4 rounded-lg" data-terpene="Myrcene">Myrcene</button>
                        <button class="action-button bg-yellow-200 text-yellow-800 font-semibold py-2 px-4 rounded-lg" data-terpene="Limonene">Limonene</button>
                        <button class="action-button bg-green-200 text-green-800 font-semibold py-2 px-4 rounded-lg" data-terpene="Pinene">Pinene</button>
                        <button class="action-button bg-purple-200 text-purple-800 font-semibold py-2 px-4 rounded-lg" data-terpene="Linalool">Linalool</button>
                        <button class="action-button bg-red-200 text-red-800 font-semibold py-2 px-4 rounded-lg col-span-2 lg:col-span-1" data-terpene="Caryophyllene">Caryophyllene</button>
                    </div>
                </div>

                <!-- Results Area -->
                <div id="results-container" class="min-h-[200px] bg-gray-100 rounded-lg p-4">
                    <div id="loading-state" class="hidden flex flex-col items-center justify-center text-gray-500">
                        <div class="loader"></div>
                        <p id="loading-text" class="mt-4 text-lg font-semibold"></p>
                    </div>
                    <div id="empty-state" class="flex flex-col items-center justify-center text-center text-gray-500 h-full pt-10">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <h3 class="text-xl font-bold text-gray-700">Welcome to the Pure Shaka Strain Guide!</h3>
                        <p>Your strain analysis will appear here.</p>
                    </div>
                    <div id="error-message" class="hidden text-center text-red-600 bg-red-100 p-4 rounded-lg"></div>
                    <div id="results" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                </div>
            </div>
        </section>

    </div>

    <script>
        // --- DOM Elements ---
        const analyzeButton = document.getElementById('analyze-button');
        const strainInput = document.getElementById('strain-input');
        const effectButtonsContainer = document.getElementById('effect-buttons');
        const terpeneButtonsContainer = document.getElementById('terpene-buttons');
        const resultsContainer = document.getElementById('results');
        const loader = document.getElementById('loading-state');
        const loadingText = document.getElementById('loading-text');
        const emptyState = document.getElementById('empty-state');
        const errorMessage = document.getElementById('error-message');

        // --- Pure Shaka Strain & Pricing Data ---
        const pureShakaMenu = [
            { name: "Monkey Pie", tier: "Smalls" },
            { name: "Octane Mint Sorbet", tier: "Smalls" },
            { name: "Blue Dream", tier: "Smalls" },
            { name: "Garlic Mintz", tier: "Smalls" },
            { name: "Orange Fruity Pebbles", tier: "Smalls" },
            { name: "Ice Cream Cake", tier: "Smalls" },
            { name: "Georgia Pie", tier: "Smalls" },
            { name: "Oreo Blizzard", tier: "Signature" },
            { name: "Bubba Kush", tier: "Supreme" },
            { name: "Purple Pomegranate", tier: "Supreme" },
            { name: "Pave", tier: "Supreme" },
            { name: "Tropical Summer", tier: "Supreme" },
            { name: "Purple Push Pop", tier: "Supreme" },
            { name: "Mac 9", tier: "Signature" },
            { name: "Hella Jelly", tier: "Signature" },
            { name: "Gush Mintz", tier: "Supreme" },
            { name: "Grape Candy", tier: "Signature" },
            { name: "White Wedding", tier: "Signature" },
            { name: "Wonder Dawg", tier: "Signature" },
            { name: "Island Cookies", tier: "Signature" },
            { name: "Illuminati", tier: "Supreme" }
        ];

        const pricing = {
            "Smalls":    "1g: $12 | 4g: $40 | 7g: $65 | 14g: $115 | 28g: $140",
            "Signature": "1g: $15 | 4g: $45 | 7g: $70 | 14g: $120 | 28g: $165",
            "Supreme":   "1g: $20 | 4g: $70 | 7g: $115 | 14g: $190 | 28g: $240"
        };
        
        const tierColors = {
            "Smalls": "text-blue-600",
            "Signature": "text-orange-500",
            "Supreme": "text-green-600"
        };

        const terpeneColors = {
            "Myrcene": "bg-blue-100 text-blue-800",
            "Limonene": "bg-yellow-100 text-yellow-800",
            "Pinene": "bg-green-100 text-green-800",
            "Linalool": "bg-purple-100 text-purple-800",
            "Caryophyllene": "bg-red-100 text-red-800",
        };
        
        const effectColors = {
            "Relaxed": "bg-indigo-100 text-indigo-800",
            "Happy": "bg-pink-100 text-pink-800",
            "Uplifted": "bg-sky-100 text-sky-800",
            "Euphoric": "bg-rose-100 text-rose-800",
            "Sleepy": "bg-slate-100 text-slate-800",
            "Focused": "bg-amber-100 text-amber-800",
            "Energetic": "bg-orange-100 text-orange-800",
            "Creative": "bg-fuchsia-100 text-fuchsia-800",
            "Pain Relief": "bg-teal-100 text-teal-800",
        };

        // --- Main Function to Call Gemini API ---
        async function getStrainData(prompt) {
            loader.classList.remove('hidden');
            emptyState.classList.add('hidden');
            resultsContainer.innerHTML = '';
            errorMessage.classList.add('hidden');
            analyzeButton.disabled = true;
            document.querySelectorAll('.action-button').forEach(btn => btn.disabled = true);

            const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = {
                contents: chatHistory,
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "strains": {
                                type: "ARRAY",
                                items: {
                                    type: "OBJECT",
                                    properties: {
                                        "strainName": { "type": "STRING" },
                                        "description": { "type": "STRING" },
                                        "strainType": { "type": "STRING" },
                                        "dominantTerpenes": { "type": "ARRAY", "items": { "type": "STRING" } },
                                        "effects": { "type": "ARRAY", "items": { "type": "STRING" } }
                                    },
                                    required: ["strainName", "description", "strainType", "dominantTerpenes", "effects"]
                                }
                            }
                        },
                        required: ["strains"]
                    }
                }
            };

            try {
                const apiKey = "AIzaSyAzkPLm9wjIbRcrl1EIr9dhiI8NoOjJXv8"; // Handled by environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`);
                const result = await response.json();

                if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts) {
                    const jsonText = result.candidates[0].content.parts[0].text;
                    const parsedJson = JSON.parse(jsonText);
                    displayResults(parsedJson.strains);
                } else {
                    throw new Error("No content received from the API.");
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                errorMessage.textContent = 'Sorry, something went wrong. Please check your input and try again.';
                errorMessage.classList.remove('hidden');
                emptyState.classList.remove('hidden');
            } finally {
                loader.classList.add('hidden');
                analyzeButton.disabled = false;
                document.querySelectorAll('.action-button').forEach(btn => btn.disabled = false);
            }
        }

        // --- Event Listener for "Analyze by Name" ---
        analyzeButton.addEventListener('click', () => {
            const strainNames = strainInput.value.split(',').map(s => s.trim()).filter(s => s);
            if (strainNames.length === 0) {
                errorMessage.textContent = 'Please enter at least one strain name.';
                errorMessage.classList.remove('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            loadingText.textContent = `Analyzing ${strainNames.join(', ')}...`;
            const menuString = pureShakaMenu.map(s => s.name).join(', ');
            const prompt = `You are an AI for a dispensary called Pure Shaka. Your available strains are strictly limited to this list: ${menuString}. From this list ONLY, analyze the following strains the user entered: ${strainNames.join(', ')}. If a user enters a strain not on the list, do not include it in the JSON output. For each valid strain, provide a brief description, its type (Indica, Sativa, or Hybrid), its likely dominant terpenes, and its most common effects.`;
            getStrainData(prompt);
        });

        // --- Event Listener for "Find by Effect" Buttons ---
        effectButtonsContainer.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const effect = e.target.dataset.effect;
                loadingText.textContent = `Finding strains for ${effect}...`;
                const menuString = pureShakaMenu.map(s => s.name).join(', ');
                const prompt = `You are an AI for a dispensary called Pure Shaka. Your available strains are strictly limited to this list: ${menuString}. From this list ONLY, recommend up to three strains that are best for the following effect: "${effect}". For each recommended strain, provide a brief description, its type (Indica, Sativa, or Hybrid), its likely dominant terpenes, and its most common effects.`;
                getStrainData(prompt);
            }
        });
        
        // --- Event Listener for "Find by Terpene" Buttons ---
        terpeneButtonsContainer.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const terpene = e.target.dataset.terpene;
                loadingText.textContent = `Finding strains high in ${terpene}...`;
                const menuString = pureShakaMenu.map(s => s.name).join(', ');
                const prompt = `You are an AI for a dispensary called Pure Shaka. Your available strains are strictly limited to this list: ${menuString}. From this list ONLY, recommend up to three strains that are dominant in the terpene "${terpene}". For each recommended strain, provide a brief description, its type (Indica, Sativa, or Hybrid), its likely dominant terpenes, and its most common effects.`;
                getStrainData(prompt);
            }
        });


        // --- Function to Display Results ---
        function displayResults(strains) {
            resultsContainer.innerHTML = '';
            if (!strains || strains.length === 0) {
                errorMessage.textContent = 'The AI could not generate information for this request. Please try a different strain or effect.';
                errorMessage.classList.remove('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            strains.forEach(strain => {
                const strainData = pureShakaMenu.find(s => s.name.toLowerCase() === strain.strainName.toLowerCase());
                if (!strainData) return; // Don't display if not on the menu

                const card = document.createElement('div');
                card.className = 'bg-white border border-gray-200 rounded-xl p-6 transform transition-all duration-500 animate-fade-in';
                
                const terpenesHtml = strain.dominantTerpenes.map(terpene => {
                    const colorClass = terpeneColors[terpene] || 'bg-gray-100 text-gray-800';
                    return `<span class="${colorClass} text-xs font-medium mr-2 px-2.5 py-1 rounded-full">${terpene}</span>`
                }).join('');

                const effectsHtml = strain.effects.map(effect => {
                    const colorClass = effectColors[effect.replace(/\s+/g, '')] || 'bg-gray-100 text-gray-800';
                    return `<span class="${colorClass} text-xs font-medium mr-2 px-2.5 py-1 rounded-full">${effect}</span>`
                }).join('');

                let typeTagColor = 'bg-gray-200 text-gray-800';
                if (strain.strainType.toLowerCase() === 'sativa') typeTagColor = 'bg-yellow-200 text-yellow-800';
                else if (strain.strainType.toLowerCase() === 'indica') typeTagColor = 'bg-purple-200 text-purple-800';
                else if (strain.strainType.toLowerCase() === 'hybrid') typeTagColor = 'bg-blue-200 text-blue-800';

                const typeTagHtml = `<span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full ${typeTagColor} ml-2 flex-shrink-0">${strain.strainType}</span>`;
                
                const tierColor = tierColors[strainData.tier] || "text-gray-700";
                const tierPrice = pricing[strainData.tier] || "N/A";

                card.innerHTML = `
                    <div class="flex items-center justify-between mb-1 flex-wrap gap-y-2">
                        <h4 class="text-xl font-bold ${tierColor}">${strain.strainName}</h4>
                        ${typeTagHtml}
                    </div>
                    <div class="mb-2">
                        <p class="font-bold text-sm ${tierColor}">${strainData.tier} Tier</p>
                        <p class="text-sm text-gray-600 font-semibold font-mono">${tierPrice}</p>
                    </div>
                    <p class="text-gray-600 mb-4 text-sm">${strain.description}</p>
                    <div class="mb-4">
                        <h5 class="font-semibold text-gray-700 mb-2 text-sm">Common Effects:</h5>
                        <div class="flex flex-wrap gap-2">${effectsHtml}</div>
                    </div>
                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2 text-sm">Likely Dominant Terpenes:</h5>
                        <div class="flex flex-wrap gap-2">${terpenesHtml}</div>
                    </div>
                `;
                resultsContainer.appendChild(card);
            });
            
            const keyframes = `@keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }`;
            const styleSheet = document.createElement("style");
            styleSheet.innerText = keyframes;
            document.head.appendChild(styleSheet);
        }
    </script>
</body>
</html>
